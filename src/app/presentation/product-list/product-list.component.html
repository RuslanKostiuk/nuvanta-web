<section class="product-list">
  <div class="product-list-header">
    <h2>Products</h2>
    <button (click)="openAddModal()" class="add-product-btn">
      + Add Product
    </button>
  </div>

  <div class="product-list-filters">
    <div class="filter">
      <label>Category</label>
      <select [(ngModel)]="categoryId">
        <option [ngValue]="null">All</option>
        @for (cat of categories(); track cat.id) {
          <option [ngValue]="cat.id">{{ cat.name }}</option>
        }
      </select>
    </div>

    <div class="filter">
      <label>Status</label>
      <select [(ngModel)]="isActive">
        <option [ngValue]="null">All</option>
        <option [ngValue]="true">Active</option>
        <option [ngValue]="false">Inactive</option>
      </select>
    </div>

    <div class="filter">
      <label>Search</label>
      <input
        [(ngModel)]="search"
        placeholder="Name or SKU"
        type="text"
      />
    </div>

    <div class="filter price-filter">
      <label>Price From</label>
      <input
        [(ngModel)]="priceFrom"
        min="0"
        placeholder="Min"
        type="number"
      />
    </div>

    <div class="filter price-filter">
      <label>Price To</label>
      <input
        [(ngModel)]="priceTo"
        min="0"
        placeholder="Max"
        type="number"
      />
    </div>

    <div class="filter">
      <label>Sort by</label>
      <select [(ngModel)]="filters().sortBy">
        <option [ngValue]="null">Default</option>
        <option value="activeFirst">Active First</option>
        <option value="inactiveFirst">Inactive First</option>
        <option value="lowestPrice">Lowest Price</option>
        <option value="highestPrice">Highest Price</option>
        <option value="mostPopular">Most Popular</option>
      </select>
    </div>

    <div class="filter clear-btn">
      <button (click)="clearFilters()" type="button">Clear All</button>
    </div>
  </div>

  @if (!products()) {
    <p>Loading products...</p>
  } @else if (products()?.length === 0) {
    <p>No products found.</p>
  } @else {
    <ul class="product-list-container">
      @for (product of products(); track product.id) {
        <app-product-row appTooltip="Click to edit product" [product]="product"
                         [categories]="categories()"></app-product-row>
      }
    </ul>
  }
</section>

@if (isDialogOpen()) {
  <app-product-add-modal (close)="isDialogOpen.set(false)"></app-product-add-modal>
}
